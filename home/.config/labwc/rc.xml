<?xml version="1.0" encoding="UTF-8"?>
<openbox_config xmlns="http://openbox.org/3.4/rc">

  <!-- ===== MENU HOOK ===== -->
  <menu>
    <file>~/.config/labwc/menu.xml</file>
    <!-- optional: delay before hiding submenus (ms)
    <hideDelay>200</hideDelay>
    -->
  </menu>

  <regions>
    <region name="left-67">
      <x>0%</x>
      <y>0%</y>
      <width>67%</width>
      <height>100%</height>
    </region>

    <region name="right-33">
      <x>67%</x>
      <y>0%</y>
      <width>33%</width>
      <height>100%</height>
    </region>

    <region name="left-50">
      <x>0%</x>
      <y>0%</y>
      <width>50%</width>
      <height>100%</height>
    </region>

    <region name="right-50">
      <x>50%</x>
      <y>0%</y>
      <width>50%</width>
      <height>100%</height>
    </region>
  </regions>

  <!-- ===== THEME & DECOR ===== -->
  <theme>
    <name>PiXonyx</name>
    <!-- Rounded corners + shadows (theme must support these) -->
    <cornerRadius>10</cornerRadius>
    <keepBorder>yes</keepBorder>
    <dropShadows>yes</dropShadows>
    <dropShadowsOnTiled>yes</dropShadowsOnTiled>

    <!-- Fonts -->
    <font place="ActiveWindow">
      <name>Inter</name>
      <size>10</size>
      <weight>Medium</weight>
      <slant>Normal</slant>
    </font>

    <font place="InactiveWindow">
      <name>Inter</name>
      <size>10</size>
      <weight>Light</weight>
      <slant>Normal</slant>
    </font>

    <font place="MenuHeader">
      <name>Inter</name>
      <size>10</size>
      <weight>Medium</weight>
      <slant>Normal</slant>
    </font>

    <font place="MenuItem">
      <name>Inter</name>
      <size>10</size>
      <weight>Regular</weight>
      <slant>Normal</slant>
    </font>

    <titlebar>
      <showTitle>yes</showTitle>
      <maximizeMode>titlebar</maximizeMode>
    </titlebar>
  </theme>

  <!-- ===== FOCUS & PLACEMENT ===== -->
  <focus>
    <followMouse>yes</followMouse>
    <raiseOnFocus>no</raiseOnFocus>
    <focusLast>yes</focusLast>
  </focus>

  <placement>
    <policy>Smart</policy>
    <center>yes</center>
    <monitor>Primary</monitor>
  </placement>

  <!-- Subtle gaps -->
  <margins>
    <top>8</top>
    <bottom>8</bottom>
    <left>8</left>
    <right>8</right>
  </margins>

  <!-- ===== EDGE SNAP UX ===== -->
  <snapping>
    <range>12</range>
    <cornerRange>48</cornerRange>
    <topMaximize>yes</topMaximize>
    <notifyClient>edge</notifyClient>
    <overlay>
      <enabled>yes</enabled>
    </overlay>
  </snapping>

  <!-- ===== MOUSE ===== -->
  <mouse>
    <!-- Right-click desktop = root menu -->
    <context name="Root">
      <mousebind button="Right" action="Press">
        <action name="ShowMenu">
          <menu>root-menu</menu>
        </action>
      </mousebind>
      <mousebind button="Middle" action="Press">
        <action name="ShowMenu">
          <menu>root-menu</menu>
        </action>
      </mousebind>
    </context>
  </mouse>

  <!-- ===== KEYBOARD (no keypad needed) ===== -->
  <keyboard>
    <default/>

    <keybind key="Super_L"/>
    <keybind key="Super_R"/>

    <!-- Launchers -->
    <keybind key="W-Return">
      <action name="Execute">
        <command>kitty</command>
      </action>
    </keybind>

    <!-- Window lifecycle -->
    <keybind key="W-Q">
      <action name="Close"/>
    </keybind>

    <keybind key="W-F">
      <action name="ToggleFullscreen"/>
    </keybind>

    <!-- Broken - W-M bound elsewhere? -->
    <keybind key="W-M">
      <action name="Execute"><command>notify-send "W-M Maximize"</command></action>
      <action name="Maximize"/>
    </keybind>

    <keybind key="W-Shift-M">
      <action name="UnMaximize"/>
    </keybind>

    <keybind key="W-S-Left">
      <action name="Foreach">
        <query>
          <focused>yes</focused>
        </query>
        <then>
          <action name="SnapToRegion" region="left-67" />
        </then>
        <else>
          <action name="SnapToRegion" region="right-33"/>
        </else>
      </action>
    </keybind>

    <keybind key="W-S-Right">
      <action name="Foreach">
        <query>
          <focused>yes</focused>
        </query>
        <then>
          <action name="SnapToRegion" region="right-33" />
        </then>
        <else>
          <action name="SnapToRegion" region="left-67"/>
        </else>
      </action>
    </keybind>

    <keybind key="W-S-Down">
      <action name="Foreach">
        <query>
          <focused>yes</focused>
        </query>
        <then>
          <action name="SnapToRegion" region="left-50" />
        </then>
        <else>
          <action name="SnapToRegion" region="right-50"/>
        </else>
      </action>
    </keybind>


    <keybind key="W-S-Up">
      <action name="ToggleFullscreen" />
    </keybind>

    <!-- Half-tiling -->
    <keybind key="W-Left">
      <action name="SnapToEdge" direction="left"/>
    </keybind>

    <keybind key="W-Right">
      <action name="SnapToEdge" direction="right"/>
    </keybind>

    <keybind key="W-Up">
      <action name="Execute"><command>notify-send "W-Up Maximize"</command></action>
      <action name="Maximize"/>
    </keybind>

    <keybind key="W-Down">
      <action name="SnapToEdge" direction="down"/>
    </keybind>

    <!-- Workspaces (3) -->
    <keybind key="W-1">
      <action name="GoToDesktop"><to>1</to></action>
    </keybind>
    <keybind key="W-2">
      <action name="GoToDesktop"><to>2</to></action>
    </keybind>
    <keybind key="W-3">
      <action name="GoToDesktop"><to>3</to></action>
    </keybind>

    <!-- Broken binding? -->
    <keybind key="W-Page_Up">
      <action name="GoToDesktop"><to>previous</to></action>
    </keybind>
    <keybind key="W-Page_Down">
      <action name="GoToDesktop"><to>next</to></action>
    </keybind>

    <keybind key="W-S-1">
      <action name="SendToDesktop"><to>1</to><follow>yes</follow></action>
    </keybind>
    <keybind key="W-S-2">
      <action name="SendToDesktop"><to>2</to><follow>yes</follow></action>
    </keybind>
    <keybind key="W-S-3">
      <action name="SendToDesktop"><to>3</to><follow>yes</follow></action>
    </keybind>

    <!-- Screenshots -->
    <keybind key="Print">
      <action name="Execute">
        <command>grim "$HOME/Pictures/screenshot-$(date +%F_%H-%M-%S).png"</command>
      </action>
    </keybind>

    <!-- Quick reconfigure -->
    <keybind key="W-Escape">
      <action name="Reconfigure"/>
      <action name="Execute"><command>notify-send "Reconfigured labwc."</command></action>
    </keybind>

    <keybind key="W-s">
      <action name="Execute"><command>notify-send "W-s fired"</command></action>
    </keybind>

    <keybind key="W-S-s">
      <action name="Execute"><command>notify-send "W-S-s fired"</command></action>
    </keybind>

    <keybind key="W-Space">
      <action name="Execute"><command>notify-send "W-Space fired"</command></action>
      <action name="Execute"><command>wofi --show drun</command></action>
    </keybind>

    <!-- Bindings do not work yet, check global settings -->

    <!-- Alt-Tab: cycle through all windows -->
    <keybind key="A-Tab">
      <action name="NextWindow">
        <allDesktops>yes</allDesktops>
        <panels>no</panels>
      </action>
    </keybind>

    <!-- Shift+Alt+Tab: reverse direction -->
    <keybind key="A-S-Tab">
      <action name="PreviousWindow">
        <allDesktops>yes</allDesktops>
        <panels>no</panels>
      </action>
    </keybind>
  </keyboard>

  <!-- ===== DESKTOPS ===== -->
  <desktops>
    <number>3</number>
    <firstdesk>1</firstdesk>
    <names>
      <name>main</name>
      <name>web</name>
      <name>aux</name>
    </names>
    <popupTime>900</popupTime>
  </desktops>

  <!-- ===== WINDOW RULES ===== -->
  <applications>
    <!-- Center dialogs -->
    <application type="dialog">
      <center>yes</center>
      <decor>yes</decor>
    </application>
  </applications>

  <!-- ===== WACOM PEN: rocker buttons ===== -->
  <tablet mouseEmulation="no">
    <!-- Tip stays left-click; map rocker: upper=Right, lower=Middle -->
    <map button="Stylus" to="Right"/>
    <map button="Stylus2" to="Middle"/>
  </tablet>

</openbox_config>

